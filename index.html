<!DOCTYPE html>
<HTML lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>Green-API test</title>
  </head>
  <style>				
		.container {
			display: flex;
			padding-left: 10%;
			padding-top:	2%
		}
		div {
			padding-left: 2%;
		}
		textarea {
			width:	300%;
			height: 80%;
		}
	</style>
	<script>
		function sendReq(func_name) {
			var xmlHttp = new XMLHttpRequest();
			var idInstance = document.getElementById("idInstance").value;
			var ApiTokenInstance = document.getElementById("ApiTokenInstance").value;
			var APIURL = "https://7103.api.greenapi.com" + "/waInstance" + idInstance + func_name + ApiTokenInstance;

			switch(func_name) {
				case "/sendMessage/":
					var chat = document.getElementById("chatId").value;
					var msg = document.getElementById("message").value;
          
					xmlHttp.open( "POST", APIURL, false ); // false for synchronous request
					xmlHttp.send(JSON.stringify({
						chatId: chat,
						message: msg
					}));
					return xmlHttp.responseText;
				case "/sendFileByUrl/":
					var chat = document.getElementById("chat2Id").value;
					var url = document.getElementById("imgUrl").value;
					xmlHttp.open( "POST", APIURL, false );
					xmlHttp.send(JSON.stringify({
            chatId: chat,
            urlFile: url,
						fileName: 'img.png',
						caption: 'testcap'
          }));
					break;
				default:
					xmlHttp.open( "GET", APIURL, false ); // false for synchronous request
					xmlHttp.send( null );
					return xmlHttp.responseText;
			}
		}

		function sendMessage() {
			var ansField = document.getElementById("fAnswer");
			ansField.value = sendReq("/sendMessage/");
		}

		function getSettings() {
			var ansField = document.getElementById("fAnswer");
			ansField.value = sendReq("/getSettings/");
		}

		function getStateInstance() {
			var ansField = document.getElementById("fAnswer");
			ansField.value = sendReq("/getStateInstance/");
		}

		function sendFile() {
			var ansField = document.getElementById("fAnswer");
			ansField.value = sendReq("/sendFileByUrl/");
		}
	</script>
	<BODY>
		<div class="container">
			<div>
				<form>		
					<input type="text" id="idInstance" value="idInstance"></br>
					<input type="text" id="ApiTokenInstance" value="ApiTokenInstance"></br>
					<button type='button' onclick="getSettings()">getSettings</button></br>
					<button type="button" onclick="getStateInstance()">getStateInstance</button></br>
				</form>
				</br>
				<form>
					<input type"text" id="chatId" value="77771234567"></br>
					<input type"text" id="message" value="Hello World!"></br>
					<button type="button" onclick="sendMessage()">sendMessage</button></br>
				</form>
				</br>
				<form>
					<input type"text" id="chat2Id" value="77771234567"></br>
					<input type"text" id="imgUrl" value="https://site.org/img/horse.png"></br>
					<button type="button" onclick="sendFile()">sendFileByUrl</button></br>
				</form>
			</div>
			<div>
				<form>
					<label for="fAnswer">Ответ:</label></br>
					<textarea type="text" class='fAnswer' id='fAnswer'></textarea>
				</form>
			</div>
		</div>
	</BODY>
</HTML>
